<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<header style="padding-bottom:50px">
<ul>
	<li style="float:left;padding-right:20px"><a href="../../index.html">Home</a></li>
</ul>
</header>

<style type="text/css">
	div{
		font-size:11pt;
	}
	p{
		text-indent:2em;/*段落缩进*/
		line-height:140%;/*行间距*/
	}
	blockquote {
		background:#f9f9f9;
		border-left:10px solid darkblue;
	}
	blockquote p {
		display:inline;
	}
</style>

<!--code examples

<a href=""></a>

<li><a style="text-decoration:none" href="#"></a></li>

<h2 id=""></h2>

<div style="text-align:center">
	<img  src="">
	<p>图 </p>
</div>
	
<sup>sup>

<div style="background:#eee;border:1px solid #ccc;padding:5px 10px;">
</div>

-->


<div>

	<!--博文标题和作者信息-->
	<h2 style="text-align:center">Mobile phones-二维树状数组</h2>
	<h5 style="text-align:right">update@2011-08-01</h5>

      <div style="background:#fdfdfd;color:black;"><br></div>     <div style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: rgb(0, 0, 0); background-color: rgb(249, 247, 237);"> <span style="color: rgb(0, 136, 0); font-style: italic;">///直接套一维的 主要代码如下</span><br> <span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">C</span><span style="color: rgb(0, 0, 0);">[(</span><span style="color: rgb(0, 0, 255);">1</span><span style="color: rgb(0, 0, 0);">&lt;&lt;</span><span style="color: rgb(0, 0, 255);">10</span>)<span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(0, 0, 255);">1</span><span style="color: rgb(0, 0, 0);">][(</span><span style="color: rgb(0, 0, 255);">1</span><span style="color: rgb(0, 0, 0);">&lt;&lt;</span><span style="color: rgb(0, 0, 255);">10</span>)<span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(0, 0, 255);">1</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(0, 0, 0);">=</span> <span style="color: rgb(0, 0, 0);">{};</span><br> <br> <span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">lowbit</span>(<span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">x</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold;">return</span> <span style="color: rgb(0, 0, 0);">x</span> <span style="color: rgb(0, 0, 0);">&amp;</span> (<span style="color: rgb(0, 0, 0);">x</span><span style="color: rgb(0, 0, 0);">^</span>(<span style="color: rgb(0, 0, 0);">x</span><span style="color: rgb(0, 0, 0);">-</span><span style="color: rgb(0, 0, 255);">1</span>));<span style="color: rgb(0, 136, 0); font-style: italic;">//这一步是把x的二进制表示中的最低位1取出来</span><br> <br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 136, 0); font-style: italic;">//x&nbsp;&nbsp; = ***100</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 136, 0); font-style: italic;">//x-1 = ***011</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 136, 0); font-style: italic;">//x ^ (x-1) = 000111</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 136, 0); font-style: italic;">//x &amp; (x ^ (x-1)) = 000100</span><br> <br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 136, 0); font-style: italic;">//return x&amp;(-x);</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 136, 0); font-style: italic;">//x&nbsp; = ***100</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 136, 0); font-style: italic;">//-x = ---011 + 1 = ---100;</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 136, 0); font-style: italic;">//x&amp;-x = 000100;</span><br> <span style="color: rgb(0, 0, 0);">}</span><br> <br> <span style="color: rgb(0, 0, 128); font-weight: bold;">void</span> <span style="color: rgb(0, 0, 0);">add</span>(<span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">upper</span><span style="color: rgb(0, 0, 0);">){</span><span style="color: rgb(0, 136, 0); font-style: italic;">//增加</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">t_i</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">t_j</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold;">for</span>(<span style="color: rgb(0, 0, 0);">t_i</span> <span style="color: rgb(0, 0, 0);">=</span> <span style="color: rgb(0, 0, 0);">x</span>;<span style="color: rgb(0, 0, 0);">t_i</span> <span style="color: rgb(0, 0, 0);">&lt;=</span> <span style="color: rgb(0, 0, 0);">upper</span>;<span style="color: rgb(0, 0, 0);">t_i</span> <span style="color: rgb(0, 0, 0);">+=</span> <span style="color: rgb(0, 0, 0);">lowbit</span>(<span style="color: rgb(0, 0, 0);">t_i</span><span style="color: rgb(0, 0, 0);">)){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold;">for</span>(<span style="color: rgb(0, 0, 0);">t_j</span> <span style="color: rgb(0, 0, 0);">=</span> <span style="color: rgb(0, 0, 0);">y</span>;<span style="color: rgb(0, 0, 0);">t_j</span> <span style="color: rgb(0, 0, 0);">&lt;=</span> <span style="color: rgb(0, 0, 0);">upper</span>;<span style="color: rgb(0, 0, 0);">t_j</span> <span style="color: rgb(0, 0, 0);">+=</span> <span style="color: rgb(0, 0, 0);">lowbit</span>(<span style="color: rgb(0, 0, 0);">t_j</span><span style="color: rgb(0, 0, 0);">)){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">C</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">t_i</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">t_j</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(0, 0, 0);">+=</span> <span style="color: rgb(0, 0, 0);">v</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> <span style="color: rgb(0, 0, 0);">}</span><br> <br> <span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">query</span>(<span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(0, 0, 0);">){</span><span style="color: rgb(0, 136, 0); font-style: italic;">//查询</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">sum</span> <span style="color: rgb(0, 0, 0);">=</span> <span style="color: rgb(0, 0, 255);">0</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">t_i</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">t_j</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold;">for</span>(<span style="color: rgb(0, 0, 0);">t_i</span> <span style="color: rgb(0, 0, 0);">=</span> <span style="color: rgb(0, 0, 0);">i</span>;<span style="color: rgb(0, 0, 0);">t_i</span> <span style="color: rgb(0, 0, 0);">&gt;</span> <span style="color: rgb(0, 0, 255);">0</span>;<span style="color: rgb(0, 0, 0);">t_i</span> <span style="color: rgb(0, 0, 0);">-=</span> <span style="color: rgb(0, 0, 0);">lowbit</span>(<span style="color: rgb(0, 0, 0);">t_i</span><span style="color: rgb(0, 0, 0);">)){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold;">for</span>(<span style="color: rgb(0, 0, 0);">t_j</span> <span style="color: rgb(0, 0, 0);">=</span> <span style="color: rgb(0, 0, 0);">j</span>;<span style="color: rgb(0, 0, 0);">t_j</span> <span style="color: rgb(0, 0, 0);">&gt;</span> <span style="color: rgb(0, 0, 255);">0</span>;<span style="color: rgb(0, 0, 0);">t_j</span> <span style="color: rgb(0, 0, 0);">-=</span> <span style="color: rgb(0, 0, 0);">lowbit</span>(<span style="color: rgb(0, 0, 0);">t_j</span><span style="color: rgb(0, 0, 0);">)){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">sum</span> <span style="color: rgb(0, 0, 0);">+=</span> <span style="color: rgb(0, 0, 0);">C</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">t_i</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">t_j</span><span style="color: rgb(0, 0, 0);">];</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 128); font-weight: bold;">return</span> <span style="color: rgb(0, 0, 0);">sum</span>;<br> <span style="color: rgb(0, 0, 0);">}</span><br> <br> <br> <span style="color: rgb(0, 136, 0); font-style: italic;">//注意add操作和query操作</span><br> <span style="color: rgb(0, 0, 0);">add</span>(<span style="color: rgb(0, 0, 0);">x</span><span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(0, 0, 255);">1</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">y</span><span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(0, 0, 255);">1</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">,</span>n);<br> <span style="color: rgb(0, 0, 0);">printf</span>(<span style="color: rgb(0, 0, 255);">"%d</span><span style="color: rgb(0, 0, 255);">\n</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">query</span>(<span style="color: rgb(0, 0, 0);">right</span><span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(0, 0, 255);">1</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">top</span><span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(0, 0, 255);">1</span>) <span style="color: rgb(0, 0, 0);">+</span> <span style="color: rgb(0, 0, 0);">query</span>(<span style="color: rgb(0, 0, 0);">left</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">bottom</span>) <span style="color: rgb(0, 0, 0);">-</span> <span style="color: rgb(0, 0, 0);">query</span>(<span style="color: rgb(0, 0, 0);">right</span><span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(0, 0, 255);">1</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">bottom</span>) <span style="color: rgb(0, 0, 0);">-</span> <span style="color: rgb(0, 0, 0);">query</span>(<span style="color: rgb(0, 0, 0);">left</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">top</span><span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(0, 0, 255);">1</span>));<br></div><br><br>  <br><hr><br><p style="font-family:微软雅黑;">题目链接：<a rel="nofollow" href="http://poj.grids.cn/practice/1195/">Mobile phones</a><br>简单的二维树状数组，先看一维的，到二维就很简单了。百度百科有个图，看那个图就能明白树状数组是什么样子的 以及为什么C[i] = A[i-2^k + 1]到A[i]的和，还有lowbit函数的意思</p>
	</div>
