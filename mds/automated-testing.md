# 简易自动化接口测试

### 前言

虽然[SKY-CLOUD.NET](http://www.sky-cloud.net)是家规模很小的公司，但在devops方面的建设可能不输大部分软件企业。因为我们是金融行业的to-B企业，对于上线后的质量要求很高，所以在开发的同时，我们的devops建设也是同步的。在产品开发之初，我们使用jira的套件来管理开发流程; 单元测试我们采用testNG, 覆盖率在97%以上, 测试代码量占比25%;我们基于jenkins和docker搭建了完善的CI/CD流程。在接口测试上我们分为两部分, 一部分是, spring-boot框架会将CRUD接口分为三个层次, controller-service-repository, 在写单元测试的时候, 会覆盖service层, 这样也间接覆盖到了接口层面的测试; 另一部分是, 在开发完接口之后, 我们用文档来记录接口测试用例并测试。在前端测试上, 我们初步用上了e2e。测试工具我们用swagger和postman。即使如此, 还是存在不少痛点。

- 接口多

  >  controller就有28个, 只算CRUD, 接口总量也达到了140个

- 单个接口需要的测试用例集较大

  >  因为我们管理的是很多不同品牌的防火墙(cisco, juniper, hillstone, checkpoint等)上的对象和策略, 边界条件很多

- 数据之间有依赖，测试时需要联动

  > 比如在调用接口之前需要获取token

- 接口之间有顺序，测试时需要联动

  > 对于功能性产品, 这应该是普遍的痛点。比如开通防火墙策略时, 要调用6个接口来完成这个过程, 中间每一步都需要用户来参与

- 部分接口的前置条件复杂，否则无法保证预期结果

  > 比如配置搜索接口, 它的预期输出依赖于设备上的配置或者叫设备状态。在A设备上测试没问题，在B设备上可能就出错了。

- 测试用例用文档沉淀，每次只能复制粘贴

  > 文档的编辑和每次测试时的复制粘贴都是非常繁琐枯燥的工作, 没人会乐意做这些事情。而且在产品迭代的过程中, 接口的变动也是很频繁的, 也进一步加剧了这个负担。

###测试框架

我个人并不热衷于造轮子, 所以调研是必要的，调研并不是实例讲解，所以本文只列出调研结果，即该框架解决了哪些问题，还有哪些问题没解决。

##### E2E



###### 解决的问题



###### 未解决的问题



