<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<header style="padding-bottom:50px">
<ul>
	<li style="float:left;padding-right:20px"><a href="../../index.html">Home</a></li>
</ul>
</header>

<style type="text/css">
	div{
		font-size:11pt;
	}
	p{
		text-indent:2em;/*段落缩进*/
		line-height:140%;/*行间距*/
	}
	blockquote {
		background:#f9f9f9;
		border-left:10px solid darkblue;
	}
	blockquote p {
		display:inline;
	}
</style>

<!--code examples

<a href=""></a>

<li><a style="text-decoration:none" href="#"></a></li>

<h2 id=""></h2>

<div style="text-align:center">
	<img  src="">
	<p>图 </p>
	</div>
		
	<sup>sup>

	<div style="background:#eee;border:1px solid #ccc;padding:5px 10px;">
	</div>

	-->


	<div>

		<!--博文标题和作者信息-->
		<h2 style="text-align:center">Minimum Cost-最小费用最大流</h2>
		<h5 style="text-align:right">update@2011-09-19</h5>
		  <div style="background:#fdfdfd;color:black;"><br></div>     <div style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);"> <span style="color: rgb(80, 112, 144);">///主要代码</span><br> <span style="color: rgb(80, 112, 144);">#define MAX 60</span><br> <span style="color: rgb(80, 112, 144);">#define INF 10000000</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">need</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(0, 0, 0);">];</span><span style="color: rgb(128, 128, 128);">//某个shopkeeper需要的</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">supply</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(0, 0, 0);">];</span><span style="color: rgb(128, 128, 128);">//某个供货点各商品的存储量</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">cost</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(0, 0, 0);">];</span><span style="color: rgb(128, 128, 128);">//cost[k][i][j] 从j运送第k种商品到j</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 208); font-weight: bold;">3</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 208); font-weight: bold;">2</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span><span style="color: rgb(0, 0, 0);">];</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">head</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 208); font-weight: bold;">3</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span><span style="color: rgb(0, 0, 0);">],</span><span style="color: rgb(0, 0, 0);">count</span>;<br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">pre_of</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 208); font-weight: bold;">3</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span><span style="color: rgb(0, 0, 0);">];</span><span style="color: rgb(128, 128, 128);">// edge(pre_of[i],i)</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> N<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">M</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">K</span>;<br> <span style="color: rgb(0, 128, 0); font-weight: bold;">struct</span> <span style="color: rgb(0, 0, 0);">node</span><span style="color: rgb(0, 0, 0);">{</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">u</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">w</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">next</span>;<br> <span style="color: rgb(0, 0, 0);">}</span><span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 208); font-weight: bold;">10</span><span style="color: rgb(0, 0, 0);">];</span><br> <br> <span style="color: rgb(48, 48, 144); font-weight: bold;">void</span> <span style="color: rgb(0, 0, 0);">add</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">u</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">w</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">u</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">u</span>;<span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">v</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">v</span>;<span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">w</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">w</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">next</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">head</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">u</span><span style="color: rgb(0, 0, 0);">];</span><span style="color: rgb(0, 0, 0);">head</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">u</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(48, 48, 48);">++</span>;<br> <span style="color: rgb(0, 0, 0);">}</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">dist</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 208); font-weight: bold;">2</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span><span style="color: rgb(0, 0, 0);">];</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">SPFA</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">k</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">source</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">sink</span><span style="color: rgb(0, 0, 0);">){</span><br> <br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">source</span>; <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> <span style="color: rgb(0, 0, 0);">sink</span>;<span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">dist</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">INF</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><span style="color: rgb(0, 0, 0);">dist</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">source</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>;<br> <br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">memset</span>(<span style="color: rgb(0, 0, 0);">pre_of</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">-</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 128, 0); font-weight: bold;">sizeof</span>(<span style="color: rgb(0, 0, 0);">pre_of</span>));<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">bool</span> <span style="color: rgb(0, 0, 0);">in_queue</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">MAX</span><span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 208); font-weight: bold;">2</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">{};</span><span style="color: rgb(128, 128, 128);">//初始化为不在队列中</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">queue</span><span style="color: rgb(48, 48, 48);">&lt;</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span><span style="color: rgb(48, 48, 48);">&gt;</span> <span style="color: rgb(0, 0, 0);">my</span>;<span style="color: rgb(0, 0, 0);">my</span><span style="color: rgb(0, 0, 0);">.</span><span style="color: rgb(0, 0, 0);">push</span>(<span style="color: rgb(0, 0, 0);">source</span>); <span style="color: rgb(0, 0, 0);">in_queue</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">source</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">true</span>;<br> <br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">while</span>(<span style="color: rgb(48, 48, 48);">!</span><span style="color: rgb(0, 0, 0);">my</span><span style="color: rgb(0, 0, 0);">.</span><span style="color: rgb(0, 0, 0);">empty</span><span style="color: rgb(0, 0, 0);">()){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">start</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">my</span><span style="color: rgb(0, 0, 0);">.</span><span style="color: rgb(0, 0, 0);">front</span>(); <span style="color: rgb(0, 0, 0);">my</span><span style="color: rgb(0, 0, 0);">.</span><span style="color: rgb(0, 0, 0);">pop</span>(); <span style="color: rgb(0, 0, 0);">in_queue</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">start</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">false</span>;<br> <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">head</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">start</span><span style="color: rgb(0, 0, 0);">];</span> <span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(48, 48, 48);">!=</span> <span style="color: rgb(48, 48, 48);">-</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">next</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">u</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">u</span><span style="color: rgb(0, 0, 0);">,</span> <span style="color: rgb(0, 0, 0);">v</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">v</span> <span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">w</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">w</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(<span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">u</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">&gt;</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span> <span style="color: rgb(48, 48, 48);">&amp;&amp;</span> <span style="color: rgb(0, 0, 0);">dist</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">&gt;</span> <span style="color: rgb(0, 0, 0);">dist</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">u</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">+</span> <span style="color: rgb(0, 0, 0);">w</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//printf("relax %d %d\n",u,v);</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">dist</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">dist</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">u</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">+</span> <span style="color: rgb(0, 0, 0);">w</span>; <span style="color: rgb(0, 0, 0);">pre_of</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">u</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(<span style="color: rgb(48, 48, 48);">!</span><span style="color: rgb(0, 0, 0);">in_queue</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">]){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">in_queue</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">true</span>;<span style="color: rgb(0, 0, 0);">my</span><span style="color: rgb(0, 0, 0);">.</span><span style="color: rgb(0, 0, 0);">push</span>(<span style="color: rgb(0, 0, 0);">v</span>);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(0, 0, 0);">dist</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">sink</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">&lt;</span> <span style="color: rgb(0, 0, 0);">INF</span>;<br> <span style="color: rgb(0, 0, 0);">}</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">bool</span> <span style="color: rgb(0, 0, 0);">isOk</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">sink</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> s <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">M</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(128, 128, 128);">//每个商店</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> s;<span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">&lt;</span> <span style="color: rgb(0, 0, 0);">sink</span>;<span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(<span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">sink</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">!=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>)<span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">false</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">true</span>;<br> <span style="color: rgb(0, 0, 0);">}</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">minCost_maxFlow</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">kind</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">source</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">sink</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//把每条边的费用权值作为边长</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//每次求最短增广路径进行增流 直到找不到增广路径</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">sum</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">while</span>(<span style="color: rgb(0, 0, 0);">SPFA</span>(<span style="color: rgb(0, 0, 0);">kind</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">source</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">sink</span><span style="color: rgb(0, 0, 0);">)){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//增流</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">min_flow</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">INF</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span>&nbsp; <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">sink</span>;<span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">!=</span> <span style="color: rgb(0, 0, 0);">source</span>;<span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">pre_of</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">]){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(<span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">pre_of</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">]][</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">&lt;</span> <span style="color: rgb(0, 0, 0);">min_flow</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">min_flow</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">pre_of</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">]][</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">];</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">sum</span> <span style="color: rgb(48, 48, 48);">+=</span> <span style="color: rgb(0, 0, 0);">dist</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">sink</span><span style="color: rgb(0, 0, 0);">]</span><span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 0);">min_flow</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span>&nbsp; <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">sink</span>; <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">!=</span> <span style="color: rgb(0, 0, 0);">source</span>;<span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">pre_of</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">]){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">u</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">pre_of</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">],</span> <span style="color: rgb(0, 0, 0);">v</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">i</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">u</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">-=</span> <span style="color: rgb(0, 0, 0);">min_flow</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">u</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">+=</span> <span style="color: rgb(0, 0, 0);">min_flow</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(<span style="color: rgb(48, 48, 48);">!</span><span style="color: rgb(0, 0, 0);">isOk</span>(<span style="color: rgb(0, 0, 0);">sink</span>))<span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(48, 48, 48);">-</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(0, 0, 0);">sum</span>;<br> <span style="color: rgb(0, 0, 0);">}</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">main</span><span style="color: rgb(0, 0, 0);">(){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">while</span>(<span style="color: rgb(0, 0, 0);">scanf</span>(<span style="background-color: rgb(255, 240, 240);">"%d%d%d"</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">&amp;</span>N<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">M</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">K</span>) <span style="color: rgb(48, 48, 48);">&amp;&amp;</span> N <span style="color: rgb(48, 48, 48);">!=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">///init</span><br> <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span>&nbsp; <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> N;<span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">j</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">j</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> <span style="color: rgb(0, 0, 0);">K</span>;<span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(48, 48, 48);">++</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">scanf</span>(<span style="background-color: rgb(255, 240, 240);">"%d"</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">need</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(0, 0, 0);">]);</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span>&nbsp; <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> <span style="color: rgb(0, 0, 0);">M</span>;<span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">j</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">j</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> <span style="color: rgb(0, 0, 0);">K</span>;<span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(48, 48, 48);">++</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">scanf</span>(<span style="background-color: rgb(255, 240, 240);">"%d"</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">supply</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(0, 0, 0);">]);</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">k</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">k</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> <span style="color: rgb(0, 0, 0);">K</span>;<span style="color: rgb(0, 0, 0);">k</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><span style="color: rgb(128, 128, 128);">//第i种商品</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> N;<span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">j</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">j</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> <span style="color: rgb(0, 0, 0);">M</span>;<span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">scanf</span>(<span style="background-color: rgb(255, 240, 240);">"%d"</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">cost</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">k</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(0, 0, 0);">]);</span><span style="color: rgb(128, 128, 128);">//j供应给i</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">total</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>;<span style="color: rgb(48, 48, 144); font-weight: bold;">bool</span> <span style="color: rgb(0, 0, 0);">flag</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">true</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">k</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">k</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> <span style="color: rgb(0, 0, 0);">K</span> <span style="color: rgb(48, 48, 48);">&amp;&amp;</span> <span style="color: rgb(0, 0, 0);">flag</span>;<span style="color: rgb(0, 0, 0);">k</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><span style="color: rgb(128, 128, 128);">//第i种商品</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//供应商是 1 到 m，之后是m+1到m+n</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">count</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>;<span style="color: rgb(0, 0, 0);">memset</span>(<span style="color: rgb(0, 0, 0);">head</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">-</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 128, 0); font-weight: bold;">sizeof</span>(<span style="color: rgb(0, 0, 0);">head</span>));<span style="color: rgb(0, 0, 0);">memset</span>(<span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 208); font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 128, 0); font-weight: bold;">sizeof</span>(<span style="color: rgb(0, 0, 0);">graph</span>));<br> <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> <span style="color: rgb(0, 0, 0);">M</span>;<span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><span style="color: rgb(128, 128, 128);">//供应商</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">j</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">j</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> N;<span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><span style="color: rgb(128, 128, 128);">//商店</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 0);">M</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">INF</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">add</span>(<span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 0);">M</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">cost</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">k</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">]);</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">add</span>(<span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 0);">M</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">-</span><span style="color: rgb(0, 0, 0);">cost</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">k</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">j</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">]);</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">source</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">sink</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">M</span><span style="color: rgb(48, 48, 48);">+</span>N<span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<br> <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">t</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">t</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> <span style="color: rgb(0, 0, 0);">M</span>;<span style="color: rgb(0, 0, 0);">t</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">source</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">t</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">supply</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">t</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">k</span><span style="color: rgb(0, 0, 0);">];</span><span style="color: rgb(128, 128, 128);">//从源点到某个供货点的流量表示供应</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">add</span>(<span style="color: rgb(0, 0, 0);">source</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">t</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>);<span style="color: rgb(128, 128, 128);">//从源点到每个供应点的距离</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">t</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>;<span style="color: rgb(0, 0, 0);">t</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> N;<span style="color: rgb(0, 0, 0);">t</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">graph</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">t</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 0);">M</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">sink</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">need</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">t</span><span style="color: rgb(0, 0, 0);">][</span><span style="color: rgb(0, 0, 0);">k</span><span style="color: rgb(0, 0, 0);">];</span><span style="color: rgb(128, 128, 128);">//第t个shopkeeper被供应的总量</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">add</span>(<span style="color: rgb(0, 0, 0);">t</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 0);">M</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">sink</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>);<span style="color: rgb(128, 128, 128);">//从每个商店到汇点</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">t</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">minCost_maxFlow</span>(<span style="color: rgb(0, 0, 0);">k</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">source</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">sink</span>);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(<span style="color: rgb(0, 0, 0);">t</span> <span style="color: rgb(48, 48, 48);">==</span> <span style="color: rgb(48, 48, 48);">-</span><span style="color: rgb(0, 0, 208); font-weight: bold;">1</span><span style="color: rgb(0, 0, 0);">){</span><span style="color: rgb(0, 0, 0);">printf</span>(<span style="background-color: rgb(255, 240, 240);">"-1</span><span style="color: rgb(96, 96, 96); font-weight: bold; background-color: rgb(255, 240, 240);">\n</span><span style="background-color: rgb(255, 240, 240);">"</span>);<span style="color: rgb(0, 0, 0);">flag</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">false</span><span style="color: rgb(0, 0, 0);">;}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">else</span> <span style="color: rgb(0, 0, 0);">total</span> <span style="color: rgb(48, 48, 48);">+=</span> <span style="color: rgb(0, 0, 0);">t</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(<span style="color: rgb(0, 0, 0);">flag</span>)<span style="color: rgb(0, 0, 0);">printf</span>(<span style="background-color: rgb(255, 240, 240);">"%d</span><span style="color: rgb(96, 96, 96); font-weight: bold; background-color: rgb(255, 240, 240);">\n</span><span style="background-color: rgb(255, 240, 240);">"</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">total</span>);<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>;<br> <span style="color: rgb(0, 0, 0);">}</span><br></div><br><br><hr><br>题目链接:<a rel="nofollow" href="http://poj.grids.cn/practice/2516/">Minimum Cost</a><br>其实求最小费用最大流的思想很简单，就是每次选取最短增广路径(路径长度为单位流量的花费)，然后计算这条路径中的最大可增的流量 进行增流.刚学SPFA所以就用SPFA写的，而且把费用图和流量图分开了。SPFA用的邻接表，所以加边的时候要加负边 否则不能回流。
	  </div>
