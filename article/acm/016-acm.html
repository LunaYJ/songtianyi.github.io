<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<header style="padding-bottom:50px">
<ul>
	<li style="float:left;padding-right:20px"><a href="../../index.html">Home</a></li>
</ul>
</header>

<style type="text/css">
	div{
		font-size:11pt;
	}
	p{
		text-indent:2em;/*段落缩进*/
		line-height:140%;/*行间距*/
	}
	blockquote {
		background:#f9f9f9;
		border-left:10px solid darkblue;
	}
	blockquote p {
		display:inline;
	}
</style>

<!--code examples

<a href=""></a>

<li><a style="text-decoration:none" href="#"></a></li>

<h2 id=""></h2>

<div style="text-align:center">
	<img  src="">
	<p>图 </p>
	</div>
		
	<sup>sup>

	<div style="background:#eee;border:1px solid #ccc;padding:5px 10px;">
	</div>

	-->


	<div>

		<!--博文标题和作者信息-->
		<h2 style="text-align:center">C Looooops-扩展欧几里德</h2>
		<h5 style="text-align:right">update@2011-09-17</h5>
		<div style="background:#fdfdfd;color:black;"><br></div>     <div style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);"> <span style="color: rgb(80, 112, 144);">#include &lt;iostream&gt;</span><br> <span style="color: rgb(80, 112, 144);">#include &lt;cstdio&gt;</span><br> <span style="color: rgb(0, 128, 0); font-weight: bold;">using</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">namespace</span> <span style="color: rgb(0, 0, 0);">std</span>;<br> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(0, 0, 0);">gcd</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(0, 0, 0);">a</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> b<span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> b <span style="color: rgb(48, 48, 48);">?</span> <span style="color: rgb(0, 0, 0);">gcd</span>( b<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">a</span> <span style="color: rgb(48, 48, 48);">%</span> b ) <span style="color: rgb(48, 48, 48);">:</span> <span style="color: rgb(0, 0, 0);">a</span>;<br> <span style="color: rgb(0, 0, 0);">}</span><br> <br> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(0, 0, 0);">Extened_Euclid</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(0, 0, 0);">a</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> b<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">x</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">y</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(b <span style="color: rgb(48, 48, 48);">==</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">x</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">1</span>; <span style="color: rgb(0, 0, 0);">y</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>; <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(0, 0, 0);">a</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">else</span><span style="color: rgb(0, 0, 0);">{</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(0, 0, 0);">gcd</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">x1</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">y1</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">gcd</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">Extened_Euclid</span>(b<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">a</span><span style="color: rgb(48, 48, 48);">%</span>b<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">x1</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">y1</span>);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">x</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">y1</span>; <span style="color: rgb(0, 0, 0);">y</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">x1</span> <span style="color: rgb(48, 48, 48);">-</span> (<span style="color: rgb(0, 0, 0);">a</span><span style="color: rgb(48, 48, 48);">/</span>b)<span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 0);">y1</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(0, 0, 0);">gcd</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> <span style="color: rgb(0, 0, 0);">}</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">main</span><span style="color: rgb(0, 0, 0);">(){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">A</span><span style="color: rgb(0, 0, 0);">,</span>B<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">C</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">K</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">while</span>(<span style="color: rgb(0, 0, 0);">scanf</span>(<span style="background-color: rgb(255, 240, 240);">"%d%d%d%d"</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">A</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">&amp;</span>B<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">C</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">K</span>) <span style="color: rgb(48, 48, 48);">&amp;&amp;</span> <span style="color: rgb(48, 48, 48);">!</span>(<span style="color: rgb(0, 0, 0);">A</span><span style="color: rgb(48, 48, 48);">==</span><span style="color: rgb(0, 0, 208); font-weight: bold;">0</span> <span style="color: rgb(48, 48, 48);">&amp;&amp;</span>B<span style="color: rgb(48, 48, 48);">==</span><span style="color: rgb(0, 0, 208); font-weight: bold;">0</span> <span style="color: rgb(48, 48, 48);">&amp;&amp;</span> <span style="color: rgb(0, 0, 0);">C</span><span style="color: rgb(48, 48, 48);">==</span><span style="color: rgb(0, 0, 208); font-weight: bold;">0</span> <span style="color: rgb(48, 48, 48);">&amp;&amp;</span><span style="color: rgb(0, 0, 0);">K</span><span style="color: rgb(48, 48, 48);">==</span><span style="color: rgb(0, 0, 208); font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">)){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//x*C = (B-A) (mod 1&lt;&lt;K)</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(48, 48, 144); font-weight: bold;">long</span> <span style="color: rgb(0, 0, 0);">a</span><span style="color: rgb(0, 0, 0);">,</span>b<span style="color: rgb(0, 0, 0);">,</span>n<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">x</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">y</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">rs</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">step</span>; n <span style="color: rgb(48, 48, 48);">=</span> (<span style="color: rgb(0, 0, 208); font-weight: bold;">1LL</span><span style="color: rgb(48, 48, 48);">&lt;&lt;</span><span style="color: rgb(0, 0, 0);">K</span>);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">a</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">C</span>;b <span style="color: rgb(48, 48, 48);">=</span> ((B<span style="color: rgb(48, 48, 48);">-</span><span style="color: rgb(0, 0, 0);">A</span>)<span style="color: rgb(48, 48, 48);">%</span>n<span style="color: rgb(48, 48, 48);">+</span>n)<span style="color: rgb(48, 48, 48);">%</span>n;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">d</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">gcd</span>(<span style="color: rgb(0, 0, 0);">a</span><span style="color: rgb(0, 0, 0);">,</span>n);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(b <span style="color: rgb(48, 48, 48);">%</span> <span style="color: rgb(0, 0, 0);">d</span> <span style="color: rgb(48, 48, 48);">!=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">printf</span>(<span style="background-color: rgb(255, 240, 240);">"FOREVER</span><span style="color: rgb(96, 96, 96); font-weight: bold; background-color: rgb(255, 240, 240);">\n</span><span style="background-color: rgb(255, 240, 240);">"</span>);<span style="color: rgb(0, 128, 0); font-weight: bold;">continue</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//ar + sn = gcd(a,n);解出 r s</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">Extened_Euclid</span>(<span style="color: rgb(0, 0, 0);">a</span><span style="color: rgb(0, 0, 0);">,</span>n<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">x</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">y</span>);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">rs</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">x</span><span style="color: rgb(48, 48, 48);">*</span>b<span style="color: rgb(48, 48, 48);">/</span><span style="color: rgb(0, 0, 0);">d</span>;<span style="color: rgb(0, 0, 0);">step</span> <span style="color: rgb(48, 48, 48);">=</span> n<span style="color: rgb(48, 48, 48);">/</span><span style="color: rgb(0, 0, 0);">d</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">printf</span>(<span style="background-color: rgb(255, 240, 240);">"%lld</span><span style="color: rgb(96, 96, 96); font-weight: bold; background-color: rgb(255, 240, 240);">\n</span><span style="background-color: rgb(255, 240, 240);">"</span><span style="color: rgb(0, 0, 0);">,(</span><span style="color: rgb(0, 0, 0);">rs</span><span style="color: rgb(48, 48, 48);">%</span><span style="color: rgb(0, 0, 0);">step</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 0);">step</span>)<span style="color: rgb(48, 48, 48);">%</span><span style="color: rgb(0, 0, 0);">step</span>);<br> <br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>;<br> <span style="color: rgb(0, 0, 0);">}</span></div><hr><br>题目链接：<a rel="nofollow" href="http://poj.grids.cn/practice/2115">C Looooops</a><br>标准做法是扩展欧几里得解同余方程，解出一个解之后算一个最小解就是答案。先看wiki上的线性同余方程的词条，再看扩展欧几里德,博客中有一篇写了<a rel="nofollow" href="010-acm.html">欧几里得的模板</a> 。long long 送了很多WA，更二的是开始的时候n没计算就加上去 = =。
	</div>
