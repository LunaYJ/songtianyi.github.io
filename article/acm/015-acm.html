<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<header style="padding-bottom:50px">
<ul>
	<li style="float:left;padding-right:20px"><a href="../../index.html">Home</a></li>
</ul>
</header>

<style type="text/css">
	div{
		font-size:11pt;
	}
	p{
		text-indent:2em;/*段落缩进*/
		line-height:140%;/*行间距*/
	}
	blockquote {
		background:#f9f9f9;
		border-left:10px solid darkblue;
	}
	blockquote p {
		display:inline;
	}
</style>

<!--code examples

<a href=""></a>

<li><a style="text-decoration:none" href="#"></a></li>

<h2 id=""></h2>

<div style="text-align:center">
	<img  src="">
	<p>图 </p>
	</div>
		
	<sup>sup>

	<div style="background:#eee;border:1px solid #ccc;padding:5px 10px;">
	</div>

	-->


	<div>

		<!--博文标题和作者信息-->
		<h2 style="text-align:center">CurrencyExchange-bellman_ford</h2>
		<h5 style="text-align:right">update@2011-09-12</h5>
		<div style="background:#fdfdfd;color:black;"><br></div>     <div style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);"> <span style="color: rgb(80, 112, 144);">//主要代码</span><br> <span style="color: rgb(80, 112, 144);">#define eps 1e-8</span><br> <span style="color: rgb(0, 128, 0); font-weight: bold;">struct</span> <span style="color: rgb(0, 0, 0);">node</span><span style="color: rgb(0, 0, 0);">{</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">from</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">to</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">double</span> <span style="color: rgb(0, 0, 0);">c</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">r</span>;<span style="color: rgb(128, 128, 128);">//c是手续费 r是汇率</span><br> <span style="color: rgb(0, 0, 0);">};</span><br> <span style="color: rgb(0, 128, 0); font-weight: bold;">struct</span> <span style="color: rgb(0, 0, 0);">node</span> <span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 208); font-weight: bold;">210</span><span style="color: rgb(0, 0, 0);">];</span><span style="color: rgb(48, 48, 144); font-weight: bold;">double</span> <span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 208); font-weight: bold;">101</span><span style="color: rgb(0, 0, 0);">];</span><span style="color: rgb(128, 128, 128);">//</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">double</span> <span style="color: rgb(0, 0, 0);">getW</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">double</span> <span style="color: rgb(0, 0, 0);">curr</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 128, 0); font-weight: bold;">const</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">struct</span> <span style="color: rgb(0, 0, 0);">node</span> <span style="color: rgb(48, 48, 48);">&amp;</span><span style="color: rgb(0, 0, 0);">a</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> (<span style="color: rgb(0, 0, 0);">curr</span><span style="color: rgb(48, 48, 48);">-</span><span style="color: rgb(0, 0, 0);">a</span><span style="color: rgb(0, 0, 0);">.</span><span style="color: rgb(0, 0, 0);">c</span>)<span style="color: rgb(48, 48, 48);">*</span><span style="color: rgb(0, 0, 0);">a</span><span style="color: rgb(0, 0, 0);">.</span><span style="color: rgb(0, 0, 0);">r</span>;<br> <span style="color: rgb(0, 0, 0);">}</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">relax_method</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> S<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> N<span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">double</span> <span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">memset</span>(<span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 208); font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 128, 0); font-weight: bold;">sizeof</span>(<span style="color: rgb(0, 0, 0);">d</span>));<span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">[</span>S<span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">v</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//d[i]也可以初始化为-INF, {i|1 &lt;= i &lt;= N and i != S}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//因为-INF一定小于getW(d[edge[i].from],edge[i])不会影响到松弛操作</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">while</span>(<span style="color: rgb(48, 48, 48);">!</span>(<span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">[</span>S<span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">-</span> <span style="color: rgb(0, 0, 0);">v</span> <span style="color: rgb(48, 48, 48);">&gt;</span> <span style="color: rgb(0, 0, 0);">eps</span><span style="color: rgb(0, 0, 0);">)){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 144); font-weight: bold;">bool</span> <span style="color: rgb(0, 0, 0);">can_relax</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">false</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">for</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span>&nbsp; <span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 208); font-weight: bold;">0</span>;<span style="color: rgb(0, 0, 0);">i</span> <span style="color: rgb(48, 48, 48);">&lt;=</span> <span style="color: rgb(0, 0, 0);">count</span>;<span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(48, 48, 48);">++</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(<span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">to</span><span style="color: rgb(0, 0, 0);">]</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 0);">eps</span> <span style="color: rgb(48, 48, 48);">&lt;</span> <span style="color: rgb(0, 0, 0);">getW</span>(<span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">from</span><span style="color: rgb(0, 0, 0);">],</span><span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">])){</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//开始总觉得两种不同币种的值进行比较不对</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//可以这样想，由于考虑了每条边，所以只有两种情况，从</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//S出发可以回到S，回到S之后就是同种币种之间的比较</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(128, 128, 128);">//如果回不到S d[S]的值肯定是没有被改变的</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">can_relax</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">true</span>;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">to</span><span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">getW</span>(<span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">from</span><span style="color: rgb(0, 0, 0);">],</span><span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">]);</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">if</span>(<span style="color: rgb(0, 0, 0);">can_relax</span> <span style="color: rgb(48, 48, 48);">==</span> <span style="color: rgb(0, 128, 0); font-weight: bold;">false</span>) <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">[</span>S<span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">&gt;</span> (<span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 0);">eps</span>);<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">}</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 128, 0); font-weight: bold;">return</span> <span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);">[</span>S<span style="color: rgb(0, 0, 0);">]</span> <span style="color: rgb(48, 48, 48);">&gt;</span> (<span style="color: rgb(0, 0, 0);">v</span><span style="color: rgb(48, 48, 48);">+</span><span style="color: rgb(0, 0, 0);">eps</span>);<br> <span style="color: rgb(0, 0, 0);">}</span><br> <span style="color: rgb(48, 48, 144); font-weight: bold;">void</span> <span style="color: rgb(0, 0, 0);">toEdge</span>(<span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">f</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">int</span> <span style="color: rgb(0, 0, 0);">t</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">double</span> <span style="color: rgb(0, 0, 0);">r</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(48, 48, 144); font-weight: bold;">double</span> <span style="color: rgb(0, 0, 0);">c</span><span style="color: rgb(0, 0, 0);">){</span><br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">from</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">f</span>;<span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">to</span> <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">t</span>;<br> &nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">r</span>&nbsp;&nbsp;&nbsp; <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">r</span>;<span style="color: rgb(0, 0, 0);">edge</span><span style="color: rgb(0, 0, 0);">[</span><span style="color: rgb(0, 0, 0);">count</span><span style="color: rgb(0, 0, 0);">].</span><span style="color: rgb(0, 0, 0);">c</span>&nbsp; <span style="color: rgb(48, 48, 48);">=</span> <span style="color: rgb(0, 0, 0);">c</span>;<br> <span style="color: rgb(0, 0, 0);">}</span></div><hr><br>题目链接:<a rel="nofollow" href="http://poj.grids.cn/practice/1860/">Currency Exchange</a><br>水题,主要用到了bellman_ford中的松弛操作,不断松弛 直到不能松弛为止<br>开始没思路，看了解题报告就去套bellman_ford，这里边权不是固定值，边权可以看作兑换前后的差值,注意下退出循环的条件
	</div>
